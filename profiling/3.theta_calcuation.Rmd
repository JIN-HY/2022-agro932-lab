---
title: "Theta calculation"
author: "Jinliang Yang"
date: "02-03-2022"
output: NULL
---

## Path Normalization

````{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
knitr::opts_knit$set(root.dir=normalizePath('..//')) 
#library(tidyverse)
```


# Wright Fisher function


```{r}
wright_fisher <- function(N=1000, A1=100, t=1000){
  p <- A1/(2*N)
  ### make a numeric vector to hold the results
  freq <- as.numeric();
  t=1000
  ### Use for loop to run over t generations
  for (i in 1:t){
    A1 <- rbinom(1, 2*N, p)
    p <- A1/(2*N)
    freq[i] <- p
  }
  return(freq)
}
```

---

## Apply the function 
```{r}
set.seed(1234587)
sim1 <- wright_fisher(N=50, t=1000, A1=20)
plot(sim1[1:100], type="o", pch=19, xlab="Generations", ylab="A1 allele count")
```

## Apply the function to conduct 1000 simulations

```{r}
set.seed(1234)
frq <- wright_fisher(N=1000, A1=100, t=1000)
pdf("graphs/sim1000.pdf", width=8, height=8)
plot(frq, type="l", ylim=c(0,1), col=3, xlab="Generations", ylab=expression(p(A[1])))
    for(u in 1:1000){
      frq <- wright_fisher(N=1000, A1=100, t=1000)
      random <- sample(1:1000,1,replace=F)
      randomcolor <- colors()[random] 
      lines(frq,type="l",col=(randomcolor))
    }
dev.off()

```


